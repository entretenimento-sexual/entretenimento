<!-- register-ui.component.html - Versão refinada e acessível -->
<form [formGroup]="form()!" (ngSubmit)="onSubmit()" class="form-wrapper">
  <!-- Condicional de exibição com form() e emailValidado -->
  <ng-container *ngIf="form() && !shouldShowSuccessMessage(); else emailVerificado">
    <h2 class="form-title">Cadastre-se</h2>

    <!-- Sucesso no envio -->
    <app-form-success-message *ngIf="shouldShowSuccessMessage()" [form]="form()!" (resendEmail)="resendEmail.emit()" />

    <!-- Campo de apelido com componente separado -->
    <app-nickname-field [form]="form()!"></app-nickname-field>

    <div class="form-field">
      <label for="email">E-mail</label>
      <input type="email" id="email"
              formControlName="email"
              placeholder="Digite seu e-mail"
              class="input-field"
              [disabled]="!nicknameValidado()"
              [class.disabled-input]="!nicknameValidado()"
              aria-label="E-mail" />
    </div>

    <div class="form-field">
      <label for="password">Escolha sua senha</label>
      <input type="password" id="password" formControlName="password" placeholder="Escolha uma senha"
        class="input-field" aria-label="Senha" />
    </div>

    <div class="form-checkbox">
      <input type="checkbox" id="termos" formControlName="aceitarTermos" />
      <label for="termos">
        Eu aceito os
        <a href="/termos" target="_blank">Termos de Uso</a> e a
        <a href="/politica-de-privacidade" target="_blank">Política de Privacidade</a>.
      </label>
    </div>

    <button type="submit" class="btn btn-primary" [disabled]="formInvalid() || isLoading()">
      {{ isLoading() ? 'Aguarde...' : 'Cadastrar' }}
    </button>

    <p class="login-redirect">
      Já tem conta?
      <a routerLink="/login">Faça login</a>
    </p>
  </ng-container>

  <!-- Template alternativo quando email já foi validado -->
  <ng-template #emailVerificado>
    <app-form-success-message [form]="form()!" (resendEmail)="resendEmail.emit()">
    </app-form-success-message>
  </ng-template>
</form>
