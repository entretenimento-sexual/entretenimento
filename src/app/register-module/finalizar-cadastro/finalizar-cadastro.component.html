<!-- src\app\authentication\finalizar-cadastro\finalizar-cadastro.component.html -->
<div class="auth-container"> <!-- Classe ajustada para manter consistência -->
  <div class="form-container"> <!-- Classe ajustada para manter consistência -->
    <h1>Finalização do Cadastro</h1>
    <p>Preencha os dados abaixo para concluir seu cadastro.</p>

    <!-- Bloco de carregamento -->
    @if (isLoading) {
      <div>
        <p>Aguarde, estamos processando sua solicitação...</p>
      </div>
    }

    <!-- Exibição de mensagens -->
    @if (!isLoading && message) {
      <div>
      <p class="alert" [ngClass]="{
          'error-message': message.includes('Erro') || message.includes('Falha') || message.includes('não coincidem'),
          'success-message': message.includes('sucesso')
        }">
          {{ message }}
        </p>
      </div>
    }

    <!-- Exibe as opções de assinatura após o sucesso da verificação de e-mail -->
    @if (showSubscriptionOptions) {
      <div>
        <h3>Deseja se tornar um assinante?</h3>
        <button class="btn-submit" (click)="goToSubscription()">Sim, quero me tornar assinante</button>
        <!-- Aplicar a classe btn-submit -->
        <button class="btn-submit" (click)="continueWithoutSubscription()">Continuar sem assinar</button>
        <!-- Aplicar a classe btn-submit -->
      </div>
    }

    <!-- Formulário de finalização de cadastro -->
    <h1>Bem-vindo à rede social do sexo!</h1>
    <p>Obrigado por verificar o seu e-mail.</p>
    <p>Continue seu cadastro para aproveitar todos os recursos!</p>

    <form (ngSubmit)="onSubmit()" #form="ngForm">
      <!-- Identidade de Gênero -->
      <label>Quero me cadastrar como:</label>
      <select [(ngModel)]="gender" name="gender" required (change)="checkFieldValidity('gender', gender)"
        class="input-field">
        <option value="homem">Homem</option>
        <option value="mulher">Mulher</option>
        <option value="casal-ele-ele">Casal (Ele/Ele)</option>
        <option value="casal-ele-ela">Casal (Ele/Ela)</option>
        <option value="casal-ela-ela">Casal (Ela/Ela)</option>
        <option value="travesti">Travesti</option>
        <option value="transexual">Transexual</option>
        <option value="crossdressers">Crossdressers</option>
      </select>
      @if (isFieldInvalid('gender')) {
        <div class="error-message">{{ formErrors['gender'] }}</div>
      }

      <!-- Orientação Sexual -->
      <label>Eu sou:</label>
      <select [(ngModel)]="orientation" name="orientation" class="input-field">
        <option value="bissexual">Bissexual</option>
        <option value="homossexual">Homossexual</option>
        <option value="heterossexual">Heterossexual</option>
        <option value="pansexual">Pansexual</option>
      </select>

      <!-- Estado -->
      <label>Estado:</label>
      <select [(ngModel)]="selectedEstado" name="estado" (change)="onEstadoChange()" class="input-field">
        @for (estado of estados; track estado) {
          <option [value]="estado.sigla">{{ estado.nome }}</option>
        }
      </select>

      <!-- Município -->
      <label>Município:</label>
      <select [(ngModel)]="selectedMunicipio" name="municipio" class="input-field">
        @for (municipio of municipios; track municipio) {
          <option [value]="municipio.nome">{{ municipio.nome }}</option>
        }
      </select>

      <!-- Upload de Fotos -->
      <label>Foto principal:</label>
      <input type="file" (change)="uploadFile($event)" multiple class="input-field">
      @if (isFieldInvalid('selectedFile')) {
        <div class="error-message">{{ formErrors['selectedFile'] }}</div>
      }

      <!-- Barra de progresso para upload de fotos -->
      @if (isUploading) {
        <div class="progress-custom">
          <div class="progress-bar-custom" role="progressbar" [attr.aria-valuenow]="progressValue" aria-valuemin="0"
          aria-valuemax="100" [style.width]="progressValue + '%'">{{progressValue | number:'1.0-0'}}%</div>
        </div>
      }

      <!-- Botão de submissão -->
      <button type="submit" [disabled]="!form.valid || isLoading" class="btn-submit">Concluir Cadastro</button>
      <!-- Classe btn-submit -->
    </form>

    @if (uploadMessage) {
      <div class="alert alert-warning">{{ uploadMessage }}</div>
    }
  </div>
</div>
