<!-- src\app\dashboard\principal\principal.component.html -->
<div class="principal-container">
  <section class="welcome-section">
    <h1>Bem-vindo de volta, {{ (currentUser$ | async)?.nickname }}!</h1>
    <p>Aqui estão algumas informações importantes para você hoje.</p>
    <p>Você recebeu ' tantas novas mensagens '</p>
    <p>Você recebeu '{{ pendingRequestsCount$ | async }}' novas solicitações de amizade</p>
    <p>Você recebeu ' x novos convites para entrar em sala de bate papo '</p>
  </section>

  <section class="online-users-section">
    <h2>Usuários Online</h2>
    <app-online-users [currentUser]="(currentUser$ | async)"></app-online-users>
  </section>

  <section class="latest-photos-section">
    <h2>Últimas Fotos</h2>
    <!-- <app-latest-photos></app-latest-photos> -->
  </section>

  <section class="friends-section" aria-labelledby="friends-heading">
    <h2 id="friends-heading">Seus Amigos</h2>

    <!-- Toolbar -->
    <div role="toolbar" aria-labelledby="friends-heading" class="friends-toolbar"
      style="display:flex;gap:.75rem;align-items:center;flex-wrap:wrap">
      <button class="btn btn-secondary" type="button" (click)="toggleExpand()" aria-controls="friends-list-region"
        [attr.aria-expanded]="expanded()">
        {{ expanded() ? 'Compactar' : 'Expandir' }}
      </button>

      <label class="sr-only" for="sortSelect">Ordenar por</label>
      <mat-select id="sortSelect" placeholder="Ordenar por" [value]="sortBy()" (valueChange)="onSortChange($event)"
        style="min-width:160px">
        <mat-option value="online">Online</mat-option>
        <mat-option value="recent">Recentes</mat-option>
        <mat-option value="distance">Distância</mat-option>
        <mat-option value="alpha">A–Z</mat-option>
      </mat-select>

      <mat-slide-toggle [checked]="filters().onlyOnline ?? false" (change)="onOnlyOnlineToggle($event.checked)">
        Só online
      </mat-slide-toggle>

      <a class="btn btn-secondary" routerLink="/friends/list">Ver Todos</a>
    </div>

    <!-- Grid de cards -->
    <div id="friends-list-region">
      <app-friend-cards [items]="(items$ | async) ?? []" [isLoading]="(loading$ | async) ?? false"
        [reachedEnd]="(reachedEnd$ | async) ?? false" [displayMode]="expanded() ? 'full' : 'dashboard'"
        [limit]="expanded() ? 0 : 6" [sortBy]="sortBy()"
        [filters]="{ onlyOnline: (filters().onlyOnline ?? false) }"></app-friend-cards>
    </div>

    @if (showSeeAll$ | async) {
    <button class="btn btn-secondary ver-todos" routerLink="/friends/list">Ver Todos</button>
    }
  </section>
</div>
